---
title: "Cleaning palnt isotope data"
author: "Camila Vargas"
date: "10/6/2021"
output: html_document
---

## Set up

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(googledrive)
library(here)
library(data.table)
library(tidyverse)
library(readxl)
library(janitor)
library(lubridate)

## Sets R not to use scientific notations
options(scipen=999) 

```


## Check all necesary files are in the raw_data folder

```{r}
## File path to raw data used in this script
raw_data_path <- here::here("raw_data")

# Count files inside the raw_data folder to make sure the number of files downloaded is what is expected.
length(list.files(raw_data_path, pattern = "plants"))

```


## Table with all the raw data files
```{r}

## List with all xls files
all_xls <- tibble(list.files(raw_data_path, pattern = c("xls", "xlsx"))) %>% 
  rename(file_name = 1) %>% 
  mutate(path = paste0(raw_data_path, "/", file_name),
         n = 1:n(),
         ### UPDATE
         type = "plant") %>% 
  unite(obj_name, type, n, sep = "_", remove = FALSE)

```

**Initial Scan**
- There are 4 files for this project. One for each of the years 2010, 2011, 2012 and one compile dataset with data from 2009 to 2012.

- Dataset for 2011 has onformation for one plant only

- Data for 2010 and 2012: is duplicate (with maybe extra) of 2010-2012 plant datasheet 


**Next Steps**
1. Read and clean compile data (2009 to 2010)
2. Identify how similar is the compile data with the dataset for each spcidic year


## Read data

Compile file

**Note**
- Sheet2 contains short metadata information

- Sheet1 has the the actual data
```{r}
## check sheet names
excel_sheets(all_xls$path[1])

plant_compile <- read_excel(all_xls$path[1], sheet = "Sheet1") %>% 
  clean_names()

```


Data per year

- The 2011 data has one entry and columns not necessarily matches the compile dataset. Therefore we are not going to incorporate this data into the "clean data" outcome of this project. We are not sure what is the correct way to include this data. Please see 2011_Palmyra_Plant_Isotop.xlsx in [Miller-ter Kuile's Github account](https://github.com/anamtk/palmyra/tree/main/raw_data/isotope_data/plants) if you need the data on this one plant.


_2010_
```{r}
## check sheet names
excel_sheets(all_xls$path[2])

plant_2010 <- read_excel(all_xls$path[2], sheet = "Sheet1") %>% 
  clean_names()
## Actually has data for 2011


## check sheet names
excel_sheets(all_xls$path[4])

plant_2012 <- read_excel(all_xls$path[4], sheet = "Sheet1", skip = 4) %>% 
  clean_names()
## this has data from 2012

```


It does not seem that data sets are the same!
Need to keep looking into detail what is the best way to organize this data!




